C51 COMPILER V9.54   TIMER0                                                                09/10/2024 14:03:05 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE TIMER0
OBJECT MODULE PLACED IN .\Objects\Timer0.obj
COMPILER INVOKED BY: D:\_EmbeddedSystemTool\Keil_v5\C51\BIN\C51.EXE Timer0.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND
                    - PRINT(.\Listings\Timer0.lst) TABS(2) OBJECT(.\Objects\Timer0.obj)

line level    source

   1          #include <REGX52.H>
   2          
   3          /**
   4            *@brief å®šæ—¶å™¨0åˆå§‹åŒ–ï¼Œ1æ¯«ç§’@12.000MHz
   5            *@param æ— 
   6            *@retval æ— 
   7            *TMODå®šæ—¶å™¨æ¨¡å¼å¯„å­˜å™¨
   8             TMOD = 0x01; //0000 0001 è¿™ä¼šå½±å“é«˜4ä½ä»£è¡¨çš„å®šæ—¶å™¨1çš„çŠ¶æ€   
   9             TMOD &= 0xf0; å³TMOD = TMOD & 0xf0;
  10             TMOD |= 0x01; å³TMOD = TMOD | 0x01;
  11             **ä¸Žæˆ–å¼èµ‹å€¼æ³•
  12             å¦‚æœ‰ä¸€ä¸ªæ•°               1010 0011
  13             å…ˆå¯¹å…¶ä¸Žä¸Š0xf0 :         1111 0000  //é«˜å››ä½ä¿æŒä¸å˜ï¼Œä½Žå››ä½æ¸…é›¶ (ä»»ä½•ä¸€ä¸ªæ•°ä¸Žä
             -¸Š1è¿˜ä¸ºå…¶æœ¬èº«ï¼Œä¸Žä¸Š0åˆ™ä¸º0)
  14                          1010 0011 & 1111 0000 = 1010 0000
  15             å†å¯¹å…¶æˆ–ä¸Šéœ€èµ‹çš„å€¼0x01 : 0000 0001 //é«˜å››ä½ä¿æŒä¸å˜ï¼Œä½Žå››ä½èµ‹å€¼ (ä»»ä½•ä¸€ä¸ªæ•°æ
             -ˆ–ä¸Š0è¿˜ä¸ºå…¶æœ¬èº«ï¼Œæˆ–ä¸Š1åˆ™ä¸º1)
  16                          1010 0000 | 0000 0001 = 1010 0001
  17            *TL0 = 64535 % 256 +1; //Timer Low 0è®¾åˆå€¼ è¿™é‡Œæœ‰å·®1usï¼šä¸+1ï¼Œåˆ™=23ï¼Œåå…­è¿›åˆ¶ä¸º0x17ï¼›+1
             - åˆ™=24 åå…­è¿›åˆ¶ä¸º0x18
  18             TH0 = 64535 / 256; //Timer High 0 è®¾åˆå€¼ çº¦ç­‰äºŽ252 åå…­è¿›åˆ¶ä¸º0xfc
  19             **16ä½å®šæ—¶å™¨1msæŽ¨å¯¼
  20             TL0ã€TH0å…±å¯è®¡æ•°0â€”â€”65535
  21             é€‰æ‹©12Tæ¨¡å¼ï¼Œæ¯éš”1usè®¡æ•° +1ï¼Œå…±å¯è®¡65535us
  22             åˆ™64535us ç¦»è®¡æ•°å™¨æº¢å‡º 65535us å·®å€¼ 1000usï¼Œå³è®¡æ—¶æ—¶é—´ä¸º1ms
  23             å°†64535 åˆ†å¼€åˆ°TL0ã€TH0
  24             è‹¥åè¿›åˆ¶123 åˆ†å¼€åˆ°ä¸¤ä¸ª0â€”â€”99çš„ç›’å­ä¸­ï¼š
  25             ä½Žä½123%100=23  é«˜ä½123/100=1  å°±åˆ†å¼€åˆ°é«˜ä½Žä½ä¸­
  26            *TCONå®šæ—¶å™¨æŽ§åˆ¶å¯„å­˜å™¨
  27             TF0 = 0; //å®šæ—¶å™¨T0æº¢å‡ºä¸­æ–­æ ‡å¿— æ¸…é›¶
  28             TR0 = 1; //å®šæ—¶å™¨T0çš„è¿è¡ŒæŽ§åˆ¶ä½ å¼€å¯è®¡æ•°
  29            *é…ç½®ä¸­æ–­å¯„å­˜å™¨ET0ã€EAã€PT0
  30            */
  31          void Timer0_Init()
  32          {
  33   1        TMOD &= 0xF0; //è®¾ç½®å®šæ—¶å™¨æ¨¡å¼
  34   1        TMOD |= 0x01; //è®¾ç½®å®šæ—¶å™¨æ¨¡å¼
  35   1        TL0 = 0x18; //è®¾ç½®å®šæ—¶åˆå€¼
  36   1        TH0 = 0xFC; //è®¾ç½®å®šæ—¶åˆå€¼
  37   1        TF0 = 0; //æ¸…é™¤TF0æ ‡å¿—
  38   1        TR0 = 1; //å®šæ—¶å™¨0å¼€å§‹è®¡æ—¶
  39   1        ET0 = 1; //T0çš„æº¢å‡ºä¸­æ–­å…è®¸ä½
  40   1        EA = 1; //CPUæ€»ä¸­æ–­å…è®¸æŽ§åˆ¶ä½
  41   1        PT0 = 0; //å®šæ—¶å™¨0ä¸­æ–­ä¼˜å…ˆçº§æŽ§åˆ¶ä½ é»˜è®¤ä¸º0  
  42   1      }
  43          
  44          /**
  45            *@brief å®šæ—¶å™¨ä¸­æ–­å­ç¨‹åº  æ¨¡æ¿ (æ”¾åœ¨ä¸»å‡½æ•°ä¸‹é¢)
  46            *@param æ— 
  47            *@retval æ— 
  48            *å‡½æ•°ä½“æ”¹æˆè‡ªå·±çš„å‡½æ•°
  49            *static unsigned int T0Count; åŠ static å°†å˜é‡å®šä¹‰æˆé™æ€å±€éƒ¨å˜é‡ï¼Œé€€å‡ºæ­¤å‡½æ•°æ—¶å˜é‡å€
             -¼ä¸ä¼šè¢«æ¸…é™¤
  50             ä¹Ÿå¯ä¸åŠ static ï¼Œä½†è¦æŠŠæ­¤å˜é‡å®šä¹‰æ”¾å¤–é¢å˜æˆå…¨å±€å˜é‡
C51 COMPILER V9.54   TIMER0                                                                09/10/2024 14:03:05 PAGE 2   

  51            *é‡æ–°èµ‹åˆå€¼1ms
  52             TL0 = 0x18; //è®¾ç½®å®šæ—¶åˆå€¼
  53             TH0 = 0xFC; //è®¾ç½®å®šæ—¶åˆå€¼
  54            *T0Count ++; //æ¯æ‰§è¡Œä¸€æ¬¡è¯¥ä¸­æ–­å­ç¨‹åº(1ms)ï¼Œå°†å˜é‡T0Count +1
  55            *if(T0Count >= 1000) //è‹¥è®¡æ•° 1000æ¬¡ åŽï¼Œå³è¿‡1såŽï¼Œæ‰§è¡Œifä¸­ç¨‹åº
  56             T0Count = 0; //å°†è®¡æ•°æ¸…é›¶ï¼Œé‡æ–°è®¡æ•°ï¼Œè¿‡1såŽï¼Œå†æ¬¡æ‰§è¡Œifä¸­ç¨‹åº
  57          ****
  58          void Timer0_Rountine() interrupt 1
  59          {
  60              static unsigned int T0Count;
  61              TL0 = 0x18;
  62              TH0 = 0xFC;
  63              T0Count ++;
  64              if(T0Count >= 1000)
  65              {
  66                  T0Count = 0;
  67                  å‡½æ•°ä½“;
  68              }
  69          }
  70            */


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     23    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
